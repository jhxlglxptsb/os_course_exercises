#lec8 虚拟内存spoc练习


NOTICE
- 有"w4l2"标记的题是助教要提交到学堂在线上的。
- 有"w4l2"和"spoc"标记的题是要求拿清华学分的同学要在实体课上完成，并按时提交到学生对应的git repo上。
- 有"hard"标记的题有一定难度，鼓励实现。
- 有"easy"标记的题很容易实现，鼓励实现。
- 有"midd"标记的题是一般水平，鼓励实现。

提前准备

- 完成lec8的视频学习和提交对应的在线练习
- git pull uco
re_os_lab, v9_cpu, os_course_spoc_exercises 　in github repos。这样可以在本机上完成课堂练习。
- 理解如何实现建立页表，给用户态建立页表，在用户态使用虚地址，产生各自也访问错误的基本应对

## 视频相关思考题
### 8.1 虚拟存储的需求背景

1. 寄存器、高速缓存、内存、外存的访问特征？
 - 访问时间递增
 - 容量递增
 - 价格递减
 - 位置越来越外围
 - 访问频率递减

2. 如何理解计算机中的存储层次结构所的理想状态是“均衡繁忙”状态？
 - 均衡繁忙指各种存储介质都处于繁忙状态且不构成系统瓶颈

3. 在你写程序时遇到过内存不够的情况吗？尝试过什么解决方法？
 - 遇到过。通过使用动态链接库，优化数据结构等来解决

### 8.2 覆盖和交换

1. 什么是覆盖技术？使用覆盖技术的程序开发者的主要工作是什么？
 - 覆盖技术依据程序逻辑结构，将程序划分为若干功能相对独立的模块；将不会同时执行的模块共享同一块内存区域
 - 程序开发者需要划分模块，确定模块间的共享关系

2. 什么是交换技术？覆盖与交换有什么不同？
 - 交换技术是江整个进程的地址空间换入换出
 - 覆盖和交换的区别：
  - 覆盖只能发生在没有调用的模块间，程序员须给出模块间的逻辑覆盖结构，发生在运行程序的内部模块间
  - 交换以进程为单位，不需要模块间的逻辑覆盖结构，发生在内存进程间

3. 覆盖和交换技术在现代计算机系统中还有需要吗？可能用在什么地方？
 - 需要。可能在多进程的时候

4. 如何分析内核模块间的依赖关系？
 - 使用编译器分析或手动分析

5. 如何获取内核模块间的函数调用列表？
 - 静态代码分析
 - 动态函数跟踪调用


### 8.3 局部性原理

1. 什么是时间局部性、空间局部性和分支局部性？
 - 时间局部性指一条指令的一次执行和下次执行，一个数据的一次访问和下次访问都集中在一个较短时期内
 - 空间局部性指当前指令和邻近的几条指令，当前访问的数据和邻近的几个数据都集中在一个较小区域内
 - 分支局部性指一条跳转指令的两次执行，很可能跳到相同的内存位置

2. 如何提高程序执行时的局部性特征？
 - 有意识地规范跳转和数据访问的顺序

3. 排序算法的局部性特征？
  * 参考：[九大排序算法再总结](http://blog.csdn.net/xiazdong/article/details/8462393)
  - 

### 8.4 虚拟存储概念

1. 什么是虚拟存储？它与覆盖和交换的区别是什么？它有什么好处和挑战？
 - 虚拟存储是在装载程序时只将当前指令执行需要的部分页面或段装入内存，将内存中暂时不用的页面或段保存到外存
 - 好处：不连续性，大用户空间，部分交换
 - 挑战：需要硬件和操作系统的共同支持

2. 虚拟存储需要什么样的支持技术？
 - 硬件：页式或短时存储中的地址转换机制
 - 操作系统：管理内存和外存间页面或段的换入和换出


### 8.5 虚拟页式存储

 1. 什么是虚拟页式存储？缺页中断处理的功能是什么？
  - 虚拟页式存储是在页式存储管理的基础上，增加请求调页和页面置换
  - 缺页处理中断可以将外存中相应的页面调入内存，使得进程能继续运行

 1. 为了支持虚拟页式存储的实现，页表项有什么修改？
  - 驻留位：表示该页是否在内存
  - 修改位：表示在内存中的该页是否被修改过
  - 访问位：表示该页面是否被访问过（读或写）
  - 保护位：表示该页的允许访问方式
  
 2. 页式存储和虚拟页式存储的区别是什么？
  - 虚拟页式存储时针对虚拟内存
  - 页式存储是对于物理内存

### 8.6 缺页异常

1. 缺页异常的处理流程？
 - 页表项引用
 - 异常
 - 查找在外存中的页面
 - 页面换入
 - 页表项修改
 - 重新执行导致异常的指令


2. 虚拟页式存储管理中有效存储访问时间是如何计算的？
 - EAT = 访存时间 * (1-p) + 缺页异常处理时间 * 缺页率p


